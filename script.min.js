document.addEventListener("DOMContentLoaded", () => {
  const players = document.querySelectorAll("#player");
  var currentLocation = window.location.search;
  var QWERTYUIOP123 = currentLocation.replace("?url=", "");

  const clapprConfig = {
    title: "PeaceTV", 
    poster: "https://peacetvid.github.io/peacetv/img/Home.png", 
    source: QWERTYUIOP123,
    crossOrigin: "anonymous",
    abr: {
      enabled: true 
    },
    shakaConfiguration: {
      drm: {
        //servers: ABCDEFGHIJKLM, 
        clearKeys: NOPQRSTUVWXYZ
      }
    },
    autoPlay: "true", 
    //autoPlayVisible: "partial",
    height: "100%",
    width: "100%",
    mediacontrol: {
        seekbar: 'rgb(32,178,170)',
        buttons: '#FFF'
    },
    plugins: [DashShakaPlayback, LevelSelector, HlsjsPlayback],
    levelSelectorConfig: {
      title: "Quality",
      labels: {
        3: "HD", //700kbps
        2: "High", //500kbps
        1: "Med", //240kbps
        0: "Low" //120kbps
      },
      labelCallback: function (playbackLevel, customLabel) {
        return customLabel + playbackLevel.level.height + "p"; //High 720p
      }
    },
    watermark: "https://peacetvid.github.io/peacetv/img/Logo.png",
    position: "top-right",
    //watermarkLink: "",
    shakaOnBeforeLoad: function (shaka_player) {}
  };
  const clappr = new Clappr.Player(clapprConfig);
  clappr.attachTo(player);
  clappr.on(Clappr.Events.PLAYER_PLAY, function () {});
});
  player.attachTo(playerElement);
        // Fungsi untuk mengubah orientasi ke landscape saat fullscreen
        player.on(Clappr.Events.PLAYER_FULLSCREEN, function() {
            if (screen.orientation && screen.orientation.lock) {
                screen.orientation.lock('landscape').catch(function(error) {
                    console.error('Orientation lock failed:', error);
                });
            }
        });

        // Kembalikan orientasi saat keluar dari fullscreen
        player.on(Clappr.Events.PLAYER_EXIT_FULLSCREEN, function() {
            if (screen.orientation && screen.orientation.unlock) {
                screen.orientation.unlock();
            }
        });

        // Event handling untuk error
        player.on(Clappr.Events.PLAYER_ERROR, function() {
            console.error('Error occurred while playing the video. Retrying...');
            setTimeout(function() {
                player.load({ source: videoFile });
                player.play();
            }, 5000); // Coba lagi setelah 5 detik
        });
